var loc_strings = {
    "English": {
        "label_offering": "Offering",
        "label_silveroffering": "Silver Dish Offering",
        "label_craving": "Satisfies Craving",
        "label_stations": "Cooking Stations",
        "label_recipes": "Top Recipes",
        "label_cook": "First Cooked By",
        "label_cook_unknown": "Someone",
        "label_cook_info": "This recipe was originally discovered by ",
        "label_cook_info_unknown": "This recipe was originally discovered by a nameless someone.",

        "pot": "Cookpot",
        "oven": "Oven",
        "grill": "Grill",

        "all": "All",
        "snack": "Snack",
        "bread": "Bread",
        "veggie": "Veggie",
        "soup": "Soup",
        "fish": "Fish",
        "meat": "Meat",
        "cheese": "Cheese",
        "pasta": "Pasta",
        "sweet": "Dessert",

        "coin1": "Old Coin",
        "coin2": "Sapphire Medallion",
        "coin3": "Red Mark",
        "coin4": "Gnaw's Favor",

        "quagmire_foliage_cooked": "Foliage",
        "quagmire_onion_cooked": "Onion",
        "quagmire_carrot_cooked": "Carrot",
        "quagmire_mushrooms_cooked": "Mushroom",
        "quagmire_crabmeat_cooked": "Crab Meat",
        "quagmire_potato_cooked": "Potato",
        "quagmire_salmon_cooked": "Salmon",
        "quagmire_cookedsmallmeat": "Meat Scraps",
        "twigs": "Twigs",
        "quagmire_turnip_cooked": "Turnip",
        "quagmire_sap": "Sap",
        "rocks": "Rocks",
        "quagmire_goatmilk": "Goat Milk",
        "quagmire_syrup": "Syrup",
        "quagmire_flour": "Flour",
        "quagmire_garlic_cooked": "Garlic",
        "berries_cooked": "Berries",
        "cookedmeat": "Meat",
        "quagmire_tomato_cooked": "Toma Root",
        "quagmire_spotspice_ground": "Spot Spice",

        "dish1": "bread",
        "dish2": "chips",
        "dish3": "veggie_soup",
        "dish4": "jelly_sandwich",
        "dish5": "fish_stew",
        "dish6": "turnip_cake",
        "dish7": "potato_pancakes",
        "dish8": "potato_soup",
        "dish9": "fishball_skewers",
        "dish10": "meatballs",
        "dish11": "meat_skewers",
        "dish12": "stone_soup",
        "dish13": "croquette",
        "dish14": "roasted_veggies",
        "dish15": "meatloaf",
        "dish16": "carrot_soup",
        "dish17": "fish_pie",
        "dish18": "fish_and_chips",
        "dish19": "meat_pie",
        "dish20": "slider",
        "dish21": "jam",
        "dish22": "jelly_roll",
        "dish23": "carrot_cake",
        "dish24": "mashed_potatoes",
        "dish25": "garlic_bread",
        "dish26": "tomato_soup",
        "dish27": "sausage",
        "dish28": "candied_fish",
        "dish29": "stuffed_mushroom",
        "dish30": "ratatouille",
        "dish31": "bruschetta",
        "dish32": "meat_stew",
        "dish33": "hamburger",
        "dish34": "fish_burger",
        "dish35": "mushroom_burger",
        "dish36": "fish_steak",
        "dish37": "curry",
        "dish38": "spaghetti_and_meatballs",
        "dish39": "lasagna",
        "dish40": "poached_fish",
        "dish41": "shepherds_pie",
        "dish42": "candy",
        "dish43": "pudding",
        "dish44": "waffles",
        "dish45": "berry_tart",
        "dish46": "mac_n_cheese",
        "dish47": "bagel_n_fish",
        "dish48": "grilled_cheese",
        "dish49": "cream_of_mushroom",
        "dish50": "pierogies",
        "dish51": "manicotti",
        "dish52": "cheeseburger",
        "dish53": "fettuccine",
        "dish54": "onion_soup",
        "dish55": "breaded_cutlet",
        "dish56": "creamy_fish",
        "dish57": "pizza",
        "dish58": "pot_roast",
        "dish59": "crab_cake",
        "dish60": "steak_frites",
        "dish61": "shooter_sandwich",
        "dish62": "bacon_wrapped_meat",
        "dish63": "crab_roll",
        "dish64": "meat_wellington",
        "dish65": "crab_ravioli",
        "dish66": "caramel_cube",
        "dish67": "scone",
        "dish68": "trifle",
        "dish69": "cheesecake",
        "dish70": "quagmire_syrup"
    },
    "繁體中文": {
        "__FILTER_CREDIT__": "需求和烹調器具篩選器由 %1 和 %2 製作！",
        "__TRANSLATION_AUTHOR__": "cheewind(https://forums.kleientertainment.com/profile/1125024-cheewind/)",
        "__TRANSLATION_CREDIT__": "%1翻譯由 %2 提供",
        "__CONTRIBUTE__": "想要增加你使用的語言? 在 git 上提交",

        "label_offering": "獻祭",
        "label_silveroffering": "銀器獻祭",
        "label_craving": "滿足需求",
        "label_stations": "烹調器具",
        "label_recipes": "常用食譜",
        "label_cook": "研製者",
        "label_cook_unknown": "某人",

        "pot": "烹煮鍋(Cookpot)",
        "oven": "窯烤爐(Oven)",
        "grill": "燒烤盤(Grill)",

        "all": "全部(All)",
        "snack": "點心(Snack)",
        "bread": "麵包(Bread)",
        "veggie": "蔬菜(Veggie)",
        "soup": "湯(Soup)",
        "fish": "魚(Fish)",
        "meat": "肉(Meat)",
        "cheese": "起司(Cheese)",
        "pasta": "義大利麵(Pasta)",
        "sweet": "甜品(Dessert)",
        "none": "無",

        "dish1": "麵包",
        "dish2": "薯片",
        "dish3": "蔬菜湯",
        "dish4": "果醬三明治",
        "dish5": "燉魚",
        "dish6": "櫻桃蘿蔔蛋糕",
        "dish7": "馬鈴薯煎餅",
        "dish8": "馬鈴薯湯",
        "dish9": "魚丸串",
        "dish10": "肉丸",
        "dish11": "肉串",
        "dish12": "石頭湯",
        "dish13": "炸肉餅",
        "dish14": "烤蔬菜",
        "dish15": "肉餅",
        "dish16": "胡蘿蔔湯",
        "dish17": "魚派",
        "dish18": "炸魚薯條",
        "dish19": "肉派",
        "dish20": "迷你漢堡",
        "dish21": "果醬",
        "dish22": "瑞士卷",
        "dish23": "蘿蔔蛋糕",
        "dish24": "馬鈴薯泥",
        "dish25": "大蒜麵包",
        "dish26": "番茄湯",
        "dish27": "香腸",
        "dish28": "蜜糖魚",
        "dish29": "釀蘑菇",
        "dish30": "普羅旺斯雜燴",
        "dish31": "普切塔",
        "dish32": "燉肉",
        "dish33": "漢堡",
        "dish34": "魚堡",
        "dish35": "蘑菇堡",
        "dish36": "魚排",
        "dish37": "咖哩",
        "dish38": "肉丸義大利麵",
        "dish39": "千層麵",
        "dish40": "嫩煎魚",
        "dish41": "牧羊人派",
        "dish42": "糖果",
        "dish43": "布丁",
        "dish44": "鬆餅",
        "dish45": "莓果塔",
        "dish46": "起司通心麵",
        "dish47": "貝果魚",
        "dish48": "起司三明治",
        "dish49": "奶油蘑菇湯",
        "dish50": "波蘭餃子",
        "dish51": "焗烤義大利通心麵",
        "dish52": "起司漢堡",
        "dish53": "義大利寬板麵",
        "dish54": "洋蔥湯",
        "dish55": "炸肉排",
        "dish56": "奶油魚",
        "dish57": "披薩",
        "dish58": "紅燒牛肉",
        "dish59": "蟹肉餅",
        "dish60": "牛排薯條",
        "dish61": "射手三明治",
        "dish62": "培根裹肉",
        "dish63": "蟹捲",
        "dish64": "威靈頓牛排",
        "dish65": "義大利蟹餃",
        "dish66": "焦糖方塊",
        "dish67": "司康",
        "dish68": "乳脂鬆糕",
        "dish69": "起司蛋糕",
        "dish70": "沼地糖漿"
    },
    "简体中文": {
        "__FILTER_CREDIT__": "需求和烹调器具筛选器由 %1 和 %2 制作！",
        "__TRANSLATION_AUTHOR__": "cheewind(https://forums.kleientertainment.com/profile/1125024-cheewind/)",
        "__TRANSLATION_CREDIT__": "%1翻译由 %2 提供",
        "__CONTRIBUTE__": "想要增加你使用的语言? 在 git 上提交",

        "label_offering": "献祭",
        "label_silveroffering": "银器献祭",
        "label_craving": "满足需求",
        "label_stations": "烹调器具",
        "label_recipes": "常用食谱",
        "label_cook": "研制者",
        "label_cook_unknown": "某人",

        "pot": "烹煮锅(Cookpot)",
        "oven": "窑烤炉(Oven)",
        "grill": "烧烤盘(Grill)",

        "all": "全部(All)",
        "snack": "点心(Snack)",
        "bread": "面包(Bread)",
        "veggie": "蔬菜(Veggie)",
        "soup": "汤(Soup)",
        "fish": "鱼(Fish)",
        "meat": "肉(Meat)",
        "cheese": "起司(Cheese)",
        "pasta": "义大利面(Pasta)",
        "sweet": "甜品(Dessert)",
        "none": "无",

        "dish1": "面包",
        "dish2": "薯片",
        "dish3": "蔬菜汤",
        "dish4": "果酱三明治",
        "dish5": "炖鱼",
        "dish6": "樱桃萝卜蛋糕",
        "dish7": "马铃薯煎饼",
        "dish8": "马铃薯汤",
        "dish9": "鱼丸串",
        "dish10": "肉丸",
        "dish11": "肉串",
        "dish12": "石头汤",
        "dish13": "炸肉饼",
        "dish14": "烤蔬菜",
        "dish15": "肉饼",
        "dish16": "胡萝卜汤",
        "dish17": "鱼派",
        "dish18": "炸鱼薯条",
        "dish19": "肉派",
        "dish20": "迷你汉堡",
        "dish21": "果酱",
        "dish22": "瑞士捲",
        "dish23": "萝卜蛋糕",
        "dish24": "马铃薯泥",
        "dish25": "大蒜面包",
        "dish26": "番茄汤",
        "dish27": "香肠",
        "dish28": "蜜糖鱼",
        "dish29": "酿蘑菇",
        "dish30": "普罗旺斯杂烩",
        "dish31": "普切塔",
        "dish32": "炖肉",
        "dish33": "汉堡",
        "dish34": "鱼堡",
        "dish35": "蘑菇堡",
        "dish36": "鱼排",
        "dish37": "咖哩",
        "dish38": "肉丸义大利面",
        "dish39": "千层面",
        "dish40": "嫩煎鱼",
        "dish41": "牧羊人派",
        "dish42": "糖果",
        "dish43": "布丁",
        "dish44": "松饼",
        "dish45": "莓果塔",
        "dish46": "起司通心面",
        "dish47": "贝果鱼",
        "dish48": "起司三明治",
        "dish49": "奶油蘑菇汤",
        "dish50": "波兰饺子",
        "dish51": "焗烤义大利通心面",
        "dish52": "起司汉堡",
        "dish53": "义大利宽板面",
        "dish54": "洋葱汤",
        "dish55": "炸肉排",
        "dish56": "奶油鱼",
        "dish57": "披萨",
        "dish58": "红烧牛肉",
        "dish59": "蟹肉饼",
        "dish60": "牛排薯条",
        "dish61": "射手三明治",
        "dish62": "培根裹肉",
        "dish63": "蟹捲",
        "dish64": "威灵顿牛排",
        "dish65": "义大利蟹饺",
        "dish66": "焦糖方块",
        "dish67": "司康",
        "dish68": "乳脂松糕",
        "dish69": "起司蛋糕",
        "dish70": "沼地糖浆"
    },
    "Русский": {
        "label_offering": "Подношение",
        "label_silveroffering": "Подношение<br>в серебре",
        "label_craving": "Удовлетворяет желание",
        "label_stations": "Кухонная станция",
        "label_recipes": "Лучшие рецепты",
        "label_cook": "Впервые приготовлено",
        "label_cook_unknown": "Кто-то",
        "label_cook_info": "Этот рецепт был первоначально обнаружен",
        "label_cook_info_unknown": "Этот рецепт был первоначально обнаружен безымянным человеком.",

        "pot": "Казан",
        "oven": "Печь",
        "grill": "Гриль",

        "all": "Все",
        "snack": "Закуса",
        "bread": "Хлеб",
        "veggie": "Овощи",
        "soup": "Суп",
        "fish": "Рыба",
        "meat": "Мясо",
        "cheese": "Сыр",
        "pasta": "Макароны",
        "sweet": "Десерт",

        "coin1": "Старая монета",
        "coin2": "Сапфировый медальон",
        "coin3": "Красный значок",
        "coin4": "Сувенир Глотки",

        "quagmire_foliage_cooked": "Листва",
        "quagmire_onion_cooked": "Лук",
        "quagmire_carrot_cooked": "Морковь",
        "quagmire_mushrooms_cooked": "Гриб",
        "quagmire_crabmeat_cooked": "Крабовое мясо",
        "quagmire_potato_cooked": "Картошка",
        "quagmire_salmon_cooked": "Лосось",
        "quagmire_cookedsmallmeat": "Куски мяса",
        "twigs": "Ветки",
        "quagmire_turnip_cooked": "Репа",
        "quagmire_sap": "Сок",
        "rocks": "Камни",
        "quagmire_goatmilk": "Козье молоко",
        "quagmire_syrup": "Сироп",
        "quagmire_flour": "Мука",
        "quagmire_garlic_cooked": "Чеснок",
        "berries_cooked": "Ягоды",
        "cookedmeat": "Мясо",
        "quagmire_tomato_cooked": "Корень томата",
        "quagmire_spotspice_ground": "Пятнистая приправа",

        "dish1": "хлеб",
        "dish2": "чипсы",
        "dish3": "овощной_суп",
        "dish4": "бутерброд_с_джемом",
        "dish5": "уха",
        "dish6": "репа-торт",
        "dish7": "драники",
        "dish8": "картофельный_суп",
        "dish9": "рыбный_шашлык",
        "dish10": "тефтели",
        "dish11": "мясной_шашлык",
        "dish12": "каменный_суп",
        "dish13": "крокеты",
        "dish14": "обжаренные_овощи",
        "dish15": "мясной_рулет",
        "dish16": "морковный_суп",
        "dish17": "рыбный_пирог",
        "dish18": "рыба_с_чипсами",
        "dish19": "мясной_пирог",
        "dish20": "слайдеры",
        "dish21": "ягодный_джем",
        "dish22": "ягодный_рулет",
        "dish23": "морковный_торт",
        "dish24": "картофельное_пюре",
        "dish25": "чесночный_хлеб",
        "dish26": "томатный_суп",
        "dish27": "сосиски",
        "dish28": "рыбки-конфетки",
        "dish29": "фаршированные_грибы",
        "dish30": "рататуй",
        "dish31": "брускетты",
        "dish32": "мясная_похлебка",
        "dish33": "гамбургер",
        "dish34": "рыбный_бургер",
        "dish35": "грибной_бургер",
        "dish36": "рыбный_стейк",
        "dish37": "карри",
        "dish38": "спагетти_с_тефтелями",
        "dish39": "лазанья",
        "dish40": "вареная_рыба",
        "dish41": "пастуший_пирог",
        "dish42": "конфеты",
        "dish43": "пудинг",
        "dish44": "вафли",
        "dish45": "ягодный_кекс",
        "dish46": "макароны_с_сыром",
        "dish47": "рыбные_бублики",
        "dish48": "жареный_сыр",
        "dish49": "грибной_суп",
        "dish50": "вареники",
        "dish51": "мэникотти",
        "dish52": "чизбургер",
        "dish53": "феттучини",
        "dish54": "луковый_суп",
        "dish55": "панированная_котлета",
        "dish56": "рыба_в_креме",
        "dish57": "пицца",
        "dish58": "тушеное_мясо",
        "dish59": "крабовый_пирог",
        "dish60": "стейк_с_картошкой_фри",
        "dish61": "бутерброд_шутера",
        "dish62": "мясо_в_беконе",
        "dish63": "крабовый_ролл",
        "dish64": "мясо_Веллингтон",
        "dish65": "крабовые_равиоли",
        "dish66": "карамельный_кубик",
        "dish67": "сконы",
        "dish68": "трайфл",
        "dish69": "чизкейк",
        "dish70": "квагмайерский_сироп"
    },
    "Português (Br)": {
        "__TRANSLATION_AUTHOR__": "Kynoox_(https://forums.kleientertainment.com/profile/978076-kynoox_/)",
        "__TRANSLATION_CREDIT__": "%1 by %2",

        "label_offering": "Oferenda",
        "label_silveroffering": "Oferenda com prato de prata",
        "label_craving": "Oferenda Satisfaz",
        "label_stations": "Estações de Cozinha",
        "label_recipes": "Melhores Receitas",
        "label_cook": "Cozinhado a primeira vez por",
        "label_cook_unknown": "Alguém",
        "label_cook_info": "Essa receita foi descoberta originalmente por ",
        "label_cook_info_unknown": "Essa receita foi descoberta originalmente por alguém sem nome.",

        "pot": "Panela",
        "oven": "Forno",
        "grill": "Grelha",

        "all": "Todos",
        "snack": "Lanche",
        "bread": "Pão",
        "veggie": "Vegetal",
        "soup": "Sopa",
        "fish": "Peixe",
        "meat": "Carne",
        "cheese": "Queija",
        "pasta": "Massa",
        "sweet": "Sobremesa",

        "coin1": "Moeda Antiga",
        "coin2": "Medalhão de Safira",
        "coin3": "Marco Vermelho",
        "coin4": "Favor do Gnaw",

        "quagmire_foliage_cooked": "Folhagem",
        "quagmire_onion_cooked": "Cebola",
        "quagmire_carrot_cooked": "Cenoura",
        "quagmire_mushrooms_cooked": "Cogumelo",
        "quagmire_crabmeat_cooked": "Carne de Carangueijo",
        "quagmire_potato_cooked": "Batata",
        "quagmire_salmon_cooked": "Salmão",
        "quagmire_cookedsmallmeat": "Pedaços de Carne",
        "twigs": "Gravetos",
        "quagmire_turnip_cooked": "Nabo",
        "quagmire_sap": "Seiva",
        "rocks": "Pedras",
        "quagmire_goatmilk": "Leite de Cabra",
        "quagmire_syrup": "Xarope",
        "quagmire_flour": "Farinha",
        "quagmire_garlic_cooked": "Garlic",
        "berries_cooked": "Bagas",
        "cookedmeat": "Carne",
        "quagmire_tomato_cooked": "Tomate",
        "quagmire_spotspice_ground": "Tempero",
    }
}

var loc_selected_language = "English";

function GorgeRecipebookLocalize() {

    // Add language buttons
    var btn_language_div = document.createElement("div");
    $(btn_language_div).attr('class', 'btn_language_div');
    for (var language in loc_strings) {
        let button = document.createElement("div");
        $(button).attr('class', "button language_btn");
        $(button).attr('for', language);
        $(button).text(language);
        $(btn_language_div).append(button);
    }
    $('.recipelist').append(btn_language_div);

    // Look for a cookie
    var language = loc_get_cookie("language");
    if (language != null && loc_strings[language] != null) loc_set_language(language);

    // Select the corresponding button
    $(".language_btn[for='" + loc_selected_language + "']").addClass("selected");

    // Setup button listener
    $('.language_btn').on('click', e => {
        // Unselect others
        $('.language_btn').removeClass('selected');

        $(e.target).addClass('selected');

        loc_set_language($(e.target).attr("for"));
    });
}

function loc_set_language(language_key) {
    loc_selected_language = language_key;

    // Update filter credit
    if (has_loc_string("__FILTER_CREDIT__")) {
        let filterCredit = loc_string("__FILTER_CREDIT__");
        filterCredit = filterCredit.replace("%1", '<a href="https://forums.kleientertainment.com/profile/1125024-cheewind/">cheewind</a>')
            .replace("%2", '<a href="https://forums.kleientertainment.com/profile/988803-adai1198/">adai1198</a>');
        $('.filter-credits').html(filterCredit);
    }

    // Update translation credit
    if (has_loc_string("__TRANSLATION_AUTHOR__")) {
        let authors = loc_string("__TRANSLATION_AUTHOR__");
        let authorList = authors.split(',');
        let authorHtml = "";
        for (let i in authorList) {
            let author = authorList[i];
            let [_, name, link] = /([^\(]+)\(([^\)]+)\)/.exec(author);
            authorHtml += `${i != 0 ? ", ":""}<a href="${link}">${name}</a>`;
        }
        let translationCredit = loc_string("__TRANSLATION_CREDIT__")
            .replace("%1", loc_selected_language).replace("%2", authorHtml);
        $('.translation-credits').html(translationCredit + "<br>");
    }

    // Update contribute
    if (has_loc_string("__TRANSLATION_AUTHOR__"))
        $('.contribute').html(loc_string("__CONTRIBUTE__")
            .replace('git', '<a href="https://github.com/kleientertainment/TheGorgeRecipeBook">git</a>') + "<br>");

    // Update cravings
    var craving_elems = $('.btn_cat_div label.button');
    for (var i = 0; i < craving_elems.length; i++) {
        $(craving_elems[i]).text(loc_string($(craving_elems[i]).attr('for')));
    }
    for (let key in craving_names) {
        craving_names[key] = loc_string(key);
    }

    // Update stations
    var station_elems = $('.btn_station_div label.button');
    for (var i = 0; i < station_elems.length; i++) {
        $(station_elems[i]).text(loc_string($(station_elems[i]).attr('for')));
    }
    for (let key in cooking_station_names) {
        cooking_station_names[key] = loc_string(key);
    }

    // Update dishname
    for (let i = 1; i < 71; ++i) {
        discovered_dishes[i].name = loc_string("dish" + i);
    }

    // Update Info
    $('.dish-tribute > label:first').text(loc_string('label_offering'));
    $('.dish-plate > label:first').text(loc_string('label_silveroffering'));
    $('.dish-craving > label:first').text(loc_string('label_craving'));
    $('.dish-station > label:first').text(loc_string('label_stations'));
    $('.dish-recipes > label:first').text(loc_string('label_recipes'));
    $('.dish-finder > label:first').text(loc_string('label_cook'));

    // Update Dish title
    $('.recipelist-dishes > li').each((_, e) => {
        let index = Number.parseInt($(e).data('index'));
        $(e).attr('title', discovered_dishes[index].name);
    })

    // Set a cookie
    loc_set_cookie("language", loc_selected_language, 6);
}

function loc_set_cookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
    var expires = "expires=" + d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function loc_get_cookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

function has_loc_string(key) {
    return key in loc_strings[loc_selected_language];
}

function loc_string(key) {
    return loc_strings[loc_selected_language][key] ||
        loc_strings["English"][key] || "Invalid String";
}
